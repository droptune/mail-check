# mchk
[![en](https://img.shields.io/badge/lang-en-green.svg)](https://github.com/droptune/mail-check/blob/master/README.md)

Простая утилита для тестирования серверов электронной почты.

Отправляет сообщение через указанный сервер и проверяет его получение по IMAP.

Можно настроить несколько разных тестов и проверять проходит сообщение или нет (смотря что требуется), например, отправляя с разных сервисов электронной почты на ваш сервер.

Создана для проверки корректной работы почтового сервера без копания в логах после внесения настроек в конфигурацию.

## Использование

Поместите конфигурацию тестов в `mchk.yml` и запустите `mchk`.

## Конфигурация

Файл конфигурации в формате [YAML](https://yaml.org/). При первом запуске создаёт пример файла в директории `~/.config/mchk/config.yml`.

Программа ищет файл конфигурации в таком порядке:
 - `~/.config/mchk/mchk.yml`
 - `~/.config/mchk.yml`
 - `mchk.yml` в текущей директории

### Пример файла конфигурации

```yaml
---
# Останавливать выполнение при возникновении ошибок или продолжить выполнение следующего теста
continue_on_errors: ха
tests:
  - name: testing service 1
    # Установите в 'no' если ожидается, что сообщение не должно быть отправлено через этот сервер
    should_send: yes
    smtp_server: smtp.example.com
    # Порт можно не указывать, по умолчанию 25
    smtp_port: 25
    send_from: user@example.com
    send_to: user@example.com
    sender_login: user@example.com
    # Если не указать этот параметр, то пароль будет запрошен при исполнении
    sender_password: password
    # Сколько секунд ждать после отправки перед попыткой найти сообщение во входящих
    wait_for: 2
    # Установите в 'no' если ожидается, что сообщение не должно быть найдено во входящих
    should_receive: yes
    imap_server: imap.example.com
    # Можно не указывать. По умолчанию 993
    imap_port: 993
    imap_login: user@example.com
    # Если не указать этот параметр, то пароль будет запрошен при исполнении
    imap_password: password
    # Удаляет тестовое сообщение с сервера, если стоит 'no'
    leave_message: no
# Далее можно настроить ещё тесты аналогичным образом
  - name: testing service 2
    # ...
```

Можно опустить параметр пароля в файле конфигурации, тогда пароль будет запрашиваться при запуске.
